<mat-toolbar class="topbar gap-10">

  <!-- Mobile Menu -->
  <button mat-icon-button (click)="toggleMobileNav.emit()" class="d-flex d-lg-none justify-content-center">
    <i-tabler name="menu-2" class="icon-20 d-flex"></i-tabler>
  </button>

  <!-- Notifications -->
  <button mat-icon-button aria-label="Notifications" routerLink="/notification">
    <i-tabler
      class="d-flex"
      name="bell"
      [matBadge]="unreadCount"
      matBadgeColor="primary"
      [matBadgeHidden]="unreadCount === 0"
    ></i-tabler>
  </button>

  <span class="flex-1-auto"></span>

  <!-- ── Dark Mode Toggle ── -->
  <button
    mat-icon-button
    (click)="toggleTheme()"
    [attr.aria-label]="(isDark$ | async) ? 'Switch to light mode' : 'Switch to dark mode'"
    class="theme-toggle-btn"
    [matTooltip]="(isDark$ | async) ? 'Light mode' : 'Dark mode'"
  >
    <i-tabler
      class="d-flex icon-20"
      [name]="(isDark$ | async) ? 'sun' : 'moon'"
    ></i-tabler>
  </button>

  <!-- Profile Dropdown -->
  <button mat-mini-fab [matMenuTriggerFor]="profilemenu" aria-label="Profile">
    <img ngSrc="/assets/images/profile/user-1.jpg" class="rounded-circle object-cover d-block" width="35" height="35"/>
  </button>

  <mat-menu #profilemenu="matMenu" class="cardWithShadow topbar-dd">
    <div class="profile-menu-header">
      <div class="profile-menu-avatar">{{ profileInitials }}</div>
      <div class="profile-menu-meta">
        <div class="profile-menu-name">{{ profileName }}</div>
        <div class="profile-menu-sub">
          <span class="role-pill" [ngClass]="roleToneClass">{{ roleLabel }}</span>
          @if (isBoutique && boutiqueName) {
            <span class="boutique-name">{{ boutiqueName }}</span>
          }
        </div>
      </div>
    </div>
    <mat-divider></mat-divider>
    <button mat-menu-item routerLink="/profil">
      <mat-icon class="d-flex align-items-center">
        <i-tabler name="user" class="icon-18 d-flex"></i-tabler>
      </mat-icon>
      Mon profil
    </button>
    <div class="p-x-12 m-t-12">
      <button mat-stroked-button class="w-100" (click)="logout()">Logout</button>
    </div>
  </mat-menu>

</mat-toolbar>
