<div class="landing-wrapper">
  <!-- ══════════════════════════════════════════
       NAVBAR
  ═══════════════════════════════════════════ -->
  <nav class="lp-navbar">
    <div class="lp-navbar__inner">
      <div class="lp-navbar__brand">
        <div class="lp-brand-icon bg-light-primary text-primary">
          <i-tabler name="building-store" class="icon-22 d-flex"></i-tabler>
        </div>
        <span class="lp-brand-name">MarketPlace</span>
      </div>

      <div class="lp-navbar__links">
        <a href="#produits" class="lp-nav-link">Produits</a>
        <a href="#how" class="lp-nav-link">Comment ça marche</a>
        <a href="#pricing" class="lp-nav-link">Tarifs</a>
        <a href="#avis-faq" class="lp-nav-link">Avis & FAQ</a>
      </div>

      <div class="lp-navbar__actions">
        <a routerLink="/authentication/login" class="lp-btn-ghost">Se connecter</a>
        <a routerLink="/authentication/register">
          <button mat-flat-button color="primary">Commencer gratuitement</button>
        </a>
      </div>
    </div>
  </nav>

  <!-- ══════════════════════════════════════════
       HERO — 2 stats, 1 card, sobre
  ═══════════════════════════════════════════ -->
  <section class="lp-hero">
    <div class="lp-hero__blob lp-hero__blob--1"></div>
    <div class="lp-hero__blob lp-hero__blob--2"></div>

    <div class="lp-hero__content lp-anim">
      <div class="lp-hero__badge bg-light-primary text-primary">
        <i-tabler name="sparkles" class="icon-13 d-flex"></i-tabler>
        Centre commercial en ligne · Antananarivo
      </div>

      <h1 class="lp-hero__title">
        Achetez, vendez &amp;<br />
        <span class="lp-hero__title-accent">développez votre commerce</span>
      </h1>

      <p class="lp-hero__subtitle text-muted">
        Des centaines de boutiques, des milliers de produits. Tout en un seul endroit — simple,
        sécurisé et accessible à tous.
      </p>

      <div class="d-flex gap-12 flex-wrap m-b-32">
        <a routerLink="/authentication/register">
          <button mat-flat-button color="primary" class="lp-btn-lg">
            <i-tabler name="shopping-bag" class="icon-18 d-flex"></i-tabler>
            Je commence maintenant
          </button>
        </a>
        <a href="#how">
          <button mat-stroked-button color="primary" class="lp-btn-lg">Comment ça marche</button>
        </a>
      </div>

      <!-- 2 stats seulement -->
      <div class="lp-hero__stats">
        @for (stat of heroStats; track stat.key) {
          <div class="lp-hero__stat">
            <div class="lp-hero__stat-value text-primary">{{ stat.value }}</div>
            <div class="text-muted f-s-12">{{ stat.label }}</div>
          </div>
          @if (!$last) {
            <div class="lp-hero__stat-sep"></div>
          }
        }
      </div>
    </div>

    <!-- Visual : 1 seule card flottante -->
    <div class="lp-hero__visual lp-anim lp-anim--delay">
      <mat-card class="cardWithShadow lp-float">
        <mat-card-content>
          <div class="d-flex align-items-center gap-12 m-b-16">
            <div class="lp-shop-avatar bg-light-primary text-primary">
              <i-tabler name="building-store" class="icon-20 d-flex"></i-tabler>
            </div>
            <div>
              <div class="f-w-600 f-s-14">Boutique Rafitra</div>
              <div class="text-muted f-s-12">Zone A · Box 104</div>
            </div>
            <span class="stat-pill bg-light-success text-success m-l-auto">Ouvert</span>
          </div>

          @for (p of heroPreviewProducts; track p.id) {
            <div class="lp-prev-row">
              <div class="lp-prev-icon" [style.background]="p.bg">
                <i-tabler [name]="p.icon" class="icon-15 d-flex"></i-tabler>
              </div>
              <div class="flex-grow-1">
                <div class="d-flex justify-content-between m-b-4">
                  <span class="f-s-13 f-w-500">{{ p.name }}</span>
                  <span class="f-s-13 f-w-600 text-primary">{{ p.price }}</span>
                </div>
                <div class="progress-track">
                  <span class="progress-fill" [style.width]="p.stock"></span>
                </div>
              </div>
            </div>
          }

          <!-- Petite notif intégrée, pas de card séparée -->
          <div class="lp-hero__notif m-t-14">
            <div class="lp-notif-dot bg-light-success text-success">
              <i-tabler name="check" class="icon-13 d-flex"></i-tabler>
            </div>
            <span class="f-s-12 f-w-600">Commande confirmée</span>
            <span class="text-muted f-s-12">· 45 000 Ar</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       PRODUITS — 3 col, 6 max, filtres simples
  ═══════════════════════════════════════════ -->
  <section class="lp-section lp-section--alt" id="produits">
    <div class="lp-section__inner">
      <div class="row align-items-center m-b-24">
        <div class="col-12 col-md-6">
          <div class="dashboard-title">
            <div class="dashboard-badge bg-light-primary text-primary">
              <i-tabler name="shopping-bag" class="icon-24 d-flex"></i-tabler>
            </div>
            <div>
              <h2 class="m-0">Produits populaires</h2>
              <div class="text-muted f-s-13">Les articles les plus achetés cette semaine</div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 d-flex justify-content-md-end m-t-12 m-t-md-0">
          <div class="lp-cat-tabs">
            @for (cat of categories; track cat.key) {
              <button
                class="lp-cat-tab"
                [class.active]="activeCategory === cat.key"
                (click)="activeCategory = cat.key"
              >
                {{ cat.label }}
              </button>
            }
          </div>
        </div>
      </div>

      <div class="row">
        @if (isLoadingProducts) {
          <div class="col-12 lp-empty">Chargement...</div>
        } @else if (productsError) {
          <div class="col-12 lp-empty text-error">{{ productsError }}</div>
        } @else if (displayedProducts.length === 0) {
          <div class="col-12 lp-empty">Aucun produit disponible.</div>
        } @else {
          @for (prod of displayedProducts; track prod.id) {
            <div class="col-12 col-sm-6 col-md-4 m-b-16">
              <mat-card class="cardWithShadow card-hover lp-prod-card h-100">
                <mat-card-content>
                  <div class="lp-prod-img">
                    @if (prod.image) {
                      <img [src]="prod.image" [alt]="prod.name" />
                    } @else {
                      <i-tabler name="photo" class="icon-40 d-flex"></i-tabler>
                    }
                    @if (prod.badge) {
                      <span class="lp-prod-badge" [ngClass]="prod.badgeClass">{{
                        prod.badge
                      }}</span>
                    }
                  </div>
                  <div class="m-t-12">
                    <div class="text-muted f-s-11 m-b-2">{{ prod.boutique }}</div>
                    <div class="f-w-600 f-s-14 m-b-8">{{ prod.name }}</div>
                    <div class="d-flex align-items-end justify-content-between m-b-12">
                      <div>
                        <div class="f-s-15 f-w-700 text-primary">{{ prod.price }}</div>
                      </div>
                      <div class="d-flex align-items-center gap-4 text-warning f-s-12 f-w-600">
                        <i-tabler name="star-filled" class="icon-13 d-flex"></i-tabler>
                        {{ prod.rating }}
                      </div>
                    </div>
                    <button
                      mat-stroked-button
                      color="primary"
                      class="w-100 f-s-13"
                      (click)="voirProduit(prod)"
                    >
                      Voir le produit
                    </button>
                  </div>
                </mat-card-content>
              </mat-card>
            </div>
          }
        }
      </div>

      <div class="d-flex justify-content-center m-t-8">
        <a routerLink="/authentication/login">
          <button mat-flat-button color="primary">
            Voir tous les produits
            <i-tabler name="arrow-right" class="icon-16 d-flex"></i-tabler>
          </button>
        </a>
      </div>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       COMMENT ÇA MARCHE
  ═══════════════════════════════════════════ -->
  <section class="lp-section" id="how">
    <div class="lp-section__inner">
      <div class="lp-section-header m-b-32">
        <div class="dashboard-title">
          <div class="dashboard-badge bg-light-secondary text-secondary">
            <i-tabler name="route" class="icon-24 d-flex"></i-tabler>
          </div>
          <div>
            <h2 class="m-0">Comment ça marche ?</h2>
            <div class="text-muted f-s-13">En 3 étapes simples, vous êtes prêt.</div>
          </div>
        </div>
        <div class="lp-how-tabs">
          <button
            class="lp-how-tab"
            [class.active]="howTab === 'acheteur'"
            (click)="howTab = 'acheteur'"
          >
            <i-tabler name="shopping-cart" class="icon-16 d-flex"></i-tabler>
            Acheteur
          </button>
          <button
            class="lp-how-tab"
            [class.active]="howTab === 'vendeur'"
            (click)="howTab = 'vendeur'"
          >
            <i-tabler name="building-store" class="icon-16 d-flex"></i-tabler>
            Vendeur
          </button>
        </div>
      </div>

      <div class="row">
        @for (step of howTab === 'acheteur' ? stepsAcheteur : stepsVendeur; track step.num) {
          <div class="col-12 col-md-4 m-b-16">
            <mat-card class="cardWithShadow h-100 lp-step-card">
              <mat-card-content>
                <div class="lp-step-num text-primary">{{ step.num }}</div>
                <div class="lp-step-icon bg-light-primary text-primary m-b-12">
                  <i-tabler [name]="step.icon" class="icon-24 d-flex"></i-tabler>
                </div>
                <div class="f-s-16 f-w-600 m-b-8">{{ step.title }}</div>
                <div class="text-muted f-s-14" style="line-height: 1.6">{{ step.desc }}</div>
              </mat-card-content>
            </mat-card>
          </div>
        }
      </div>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       TARIFS
  ═══════════════════════════════════════════ -->
  <section class="lp-section lp-section--alt" id="pricing">
    <div class="lp-section__inner">
      <div class="dashboard-title m-b-32">
        <div class="dashboard-badge bg-light-warning text-warning">
          <i-tabler name="tag" class="icon-24 d-flex"></i-tabler>
        </div>
        <div>
          <h2 class="m-0">Tarifs transparents</h2>
          <div class="text-muted f-s-13">Des offres adaptées à chaque profil, sans surprise.</div>
        </div>
      </div>

      <div class="row">
        @for (plan of plans; track plan.key) {
          <div class="col-12 col-md-4 m-b-16">
            <mat-card
              class="cardWithShadow h-100 lp-plan-card"
              [class.lp-plan-card--featured]="plan.featured"
            >
              <mat-card-content>
                @if (plan.featured) {
                  <div class="lp-plan-featured-tag">
                    <i-tabler name="star-filled" class="icon-12 d-flex"></i-tabler>
                    Populaire
                  </div>
                }
                <div class="d-flex align-items-center gap-12 m-b-16">
                  <div class="kpi-icon" [ngClass]="plan.iconClass">
                    <i-tabler [name]="plan.icon" class="icon-20 d-flex"></i-tabler>
                  </div>
                  <div class="f-s-15 f-w-600">{{ plan.name }}</div>
                </div>
                <div class="d-flex align-items-baseline gap-6 m-b-4">
                  <span class="lp-plan-amount">{{ plan.price }}</span>
                  @if (plan.period) {
                    <span class="text-muted f-s-13">{{ plan.period }}</span>
                  }
                </div>
                <div class="text-muted f-s-13 m-b-16 lp-plan-desc">{{ plan.desc }}</div>
                <div class="d-flex flex-col gap-10 m-b-20">
                  @for (f of plan.features; track f) {
                    <div class="d-flex align-items-center gap-8 f-s-13">
                      <i-tabler name="check" class="icon-16 d-flex text-success"></i-tabler>
                      {{ f }}
                    </div>
                  }
                </div>
                <a routerLink="/authentication/register">
                  @if (plan.featured) {
                    <button mat-flat-button color="primary" class="w-100">{{ plan.cta }}</button>
                  } @else {
                    <button mat-stroked-button color="primary" class="w-100">{{ plan.cta }}</button>
                  }
                </a>
              </mat-card-content>
            </mat-card>
          </div>
        }
      </div>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       AVIS + FAQ — section fusionnée 2 col
  ═══════════════════════════════════════════ -->
  <section class="lp-section" id="avis-faq">
    <div class="lp-section__inner">
      <div class="row">
        <!-- Gauche : 3 avis empilés -->
        <div class="col-12 col-lg-5">
          <div class="dashboard-title m-b-20">
            <div class="dashboard-badge bg-light-success text-success">
              <i-tabler name="heart" class="icon-24 d-flex"></i-tabler>
            </div>
            <div>
              <h2 class="m-0">Avis clients</h2>
              <div class="text-muted f-s-13">Ce qu'ils disent de nous</div>
            </div>
          </div>

          @for (t of testimonials.slice(0, 3); track t.id) {
            <mat-card class="cardWithShadow m-b-12" [class.lp-testi-featured]="t.featured">
              <mat-card-content>
                <div class="d-flex gap-2 m-b-8">
                  @for (s of [1, 2, 3, 4, 5]; track s) {
                    <i-tabler name="star-filled" class="icon-13 d-flex text-warning"></i-tabler>
                  }
                </div>
                <p class="f-s-13 lp-testi-quote m-b-12">"{{ t.quote }}"</p>
                <div class="d-flex align-items-center gap-10">
                  <div class="lp-testi-avatar bg-light-primary text-primary">{{ t.initials }}</div>
                  <div>
                    <div class="f-w-600 f-s-13">{{ t.name }}</div>
                    <div class="text-muted f-s-12">{{ t.role }}</div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          }
        </div>

        <!-- Séparateur vertical desktop -->
        <div class="col-lg-1 lp-vsep-col d-none d-lg-flex">
          <div class="lp-vsep"></div>
        </div>

        <!-- Droite : FAQ accordion -->
        <div class="col-12 col-lg-6 m-t-32 m-t-lg-0">
          <div class="dashboard-title m-b-20">
            <div class="dashboard-badge bg-light-error text-error">
              <i-tabler name="help-circle" class="icon-24 d-flex"></i-tabler>
            </div>
            <div>
              <h2 class="m-0">Questions fréquentes</h2>
              <div class="text-muted f-s-13">Tout savoir avant de commencer</div>
            </div>
          </div>

          @for (item of faqs; track item.id) {
            <mat-card class="cardWithShadow lp-faq-card m-b-8" (click)="toggleFaq(item)">
              <mat-card-content>
                <div class="d-flex align-items-center justify-content-between gap-16">
                  <span class="f-s-14 f-w-600">{{ item.question }}</span>
                  <div class="lp-faq-toggle bg-light-primary text-primary">
                    <i-tabler
                      [name]="item.open ? 'minus' : 'plus'"
                      class="icon-16 d-flex"
                    ></i-tabler>
                  </div>
                </div>
                @if (item.open) {
                  <div class="text-muted f-s-13 m-t-12 lp-faq-answer">{{ item.answer }}</div>
                }
              </mat-card-content>
            </mat-card>
          }
        </div>
      </div>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       CTA FINAL
  ═══════════════════════════════════════════ -->
  <section class="lp-cta">
    <div class="lp-cta__blob"></div>
    <div class="lp-cta__inner">
      <div class="dashboard-badge bg-light-primary text-primary lp-cta__badge">
        <i-tabler name="rocket" class="icon-26 d-flex"></i-tabler>
      </div>
      <h2 class="lp-cta__title m-0">Prêt à rejoindre le marché ?</h2>
      <p class="text-muted f-s-15 m-0">
        Inscrivez-vous gratuitement et explorez des centaines de boutiques dès aujourd'hui.
      </p>
      <div class="d-flex gap-12 justify-content-center flex-wrap">
        <a routerLink="/authentication/register">
          <button mat-flat-button color="primary" class="lp-btn-lg">
            <i-tabler name="user-plus" class="icon-18 d-flex"></i-tabler>
            Créer mon compte gratuit
          </button>
        </a>
        <a routerLink="/authentication/login">
          <button mat-stroked-button color="primary" class="lp-btn-lg">Se connecter</button>
        </a>
      </div>
    </div>
  </section>

  <!-- ══════════════════════════════════════════
       FOOTER
  ═══════════════════════════════════════════ -->
  <footer class="lp-footer" id="contact">
    <div class="lp-footer__inner">
      <div class="lp-footer__top">
        <div class="lp-footer__brand">
          <div class="d-flex align-items-center gap-10 m-b-12">
            <div class="lp-brand-icon bg-light-primary text-primary">
              <i-tabler name="building-store" class="icon-20 d-flex"></i-tabler>
            </div>
            <span class="lp-brand-name">MarketPlace</span>
          </div>
          <p class="text-muted f-s-13 m-b-16">
            Le centre commercial qui connecte acheteurs et vendeurs à Madagascar.
          </p>
          <div class="d-flex gap-8">
            @for (s of socials; track s.icon) {
              <a [href]="s.url" class="lp-social-btn bg-light-primary text-primary">
                <i-tabler [name]="s.icon" class="icon-16 d-flex"></i-tabler>
              </a>
            }
          </div>
        </div>

        <div class="lp-footer__col">
          <div class="lp-footer__col-title">Navigation</div>
          <a href="#produits" class="lp-footer__link">Produits</a>
          <a href="#how" class="lp-footer__link">Comment ça marche</a>
          <a href="#pricing" class="lp-footer__link">Tarifs</a>
          <a href="#avis-faq" class="lp-footer__link">Avis & FAQ</a>
        </div>

        <div class="lp-footer__col">
          <div class="lp-footer__col-title">Compte</div>
          <a routerLink="/authentication/login" class="lp-footer__link">Se connecter</a>
          <a routerLink="/authentication/register" class="lp-footer__link">S'inscrire</a>
          <a href="#" class="lp-footer__link">Espace vendeur</a>
          <a href="#" class="lp-footer__link">Espace acheteur</a>
        </div>

        <div class="lp-footer__col">
          <div class="lp-footer__col-title">Contact</div>
          <div class="d-flex align-items-center gap-8 f-s-13 text-muted m-b-8">
            <i-tabler name="map-pin" class="icon-15 d-flex text-primary"></i-tabler>
            Antananarivo, Madagascar
          </div>
          <div class="d-flex align-items-center gap-8 f-s-13 text-muted m-b-8">
            <i-tabler name="phone" class="icon-15 d-flex text-primary"></i-tabler>
            +261 XX XXX XXXX
          </div>
          <div class="d-flex align-items-center gap-8 f-s-13 text-muted">
            <i-tabler name="mail" class="icon-15 d-flex text-primary"></i-tabler>
            contact&#64;marketplace.mg
          </div>
        </div>
      </div>

      <div class="lp-footer__bottom">
        <span class="text-muted f-s-12"
          >© {{ currentYear }} MarketPlace. Tous droits réservés.</span
        >
        <div class="d-flex gap=8"></div>
        <span class="text-muted f-s-12"
          ><strong>RAZAFINDRAKOTO Zo Nantenaina | RAZAFINDRAKOTO Tovoarinaina Ando</strong></span
        >
        <div class="d-flex gap-16">
          <a href="#" class="lp-footer__link f-s-12">Confidentialité</a>
          <a href="#" class="lp-footer__link f-s-12">Conditions d'utilisation</a>
        </div>
      </div>
    </div>
  </footer>
</div>
