<div class="auth-wrapper auth-wrapper--wide">
  <!-- Blobs décoratifs fond -->
  <div class="auth-blob auth-blob--1"></div>
  <div class="auth-blob auth-blob--2"></div>

  <div class="auth-card-wrap auth-card-wrap--wide">
    <mat-card class="cardWithShadow auth-card">
      <mat-card-content>
        <!-- ── Logo ── -->
        <div class="auth-logo">
          <a [routerLink]="['/']" class="app-brand">
            <span class="app-brand__icon bg-light-primary text-primary">
              <i-tabler name="building-store" class="icon-20 d-flex"></i-tabler>
            </span>
            <span class="app-brand__name">MarketPlace</span>
          </a>
        </div>

        <!-- ── Titre ── -->
        <div class="auth-title">
          <h2 class="f-s-20 f-w-700 m-0">Créer un compte boutique</h2>
          <p class="text-muted f-s-13 m-0 m-t-4">
            Remplissez les informations ci-dessous pour créer votre boutique
          </p>
        </div>

        <!-- ── Switcher Client / Boutique ── -->
        <div class="profile-switcher">
          <a class="profile-tab" [routerLink]="['/authentication/register-client']">
            <span class="profile-tab__icon bg-light-primary text-primary">
              <i-tabler name="user" class="icon-16 d-flex"></i-tabler>
            </span>
            <span class="profile-tab__label">Client</span>
          </a>
          <a class="profile-tab active" [routerLink]="['/authentication/register-boutique']">
            <span class="profile-tab__icon bg-light-warning text-warning">
              <i-tabler name="building-store" class="icon-16 d-flex"></i-tabler>
            </span>
            <span class="profile-tab__label">Boutique</span>
          </a>
        </div>

        <!-- ── Formulaire 2 colonnes ── -->
        <form [formGroup]="form" (ngSubmit)="submit()">
          <div class="row g-4">
            <!-- ── Colonne gauche : Infos utilisateur ── -->
            <div class="col-12 col-lg-6">
              <div class="auth-section">
                <div class="auth-section__header">
                  <div class="dashboard-badge bg-light-primary text-primary">
                    <i-tabler name="user" class="icon-20 d-flex"></i-tabler>
                  </div>
                  <div>
                    <div class="f-s-15 f-w-600">Informations utilisateur</div>
                    <div class="text-muted f-s-12">Vos informations personnelles</div>
                  </div>
                </div>

                <!-- Nom + Prénom -->
                <div class="row">
                  <div class="col-12 col-sm-6">
                    <div class="auth-field">
                      <mat-label class="auth-field__label">Nom</mat-label>
                      <mat-form-field appearance="outline" class="w-100" color="primary">
                        <input
                          matInput
                          formControlName="nom"
                          autocomplete="family-name"
                          placeholder="Rakoto"
                        />
                        <mat-error *ngIf="f.nom.touched && f.nom.hasError('required')"
                          >Le nom est requis.</mat-error
                        >
                        <mat-error *ngIf="f.nom.touched && f.nom.hasError('minlength')"
                          >2 caractères minimum.</mat-error
                        >
                      </mat-form-field>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6">
                    <div class="auth-field">
                      <mat-label class="auth-field__label">Prénom</mat-label>
                      <mat-form-field appearance="outline" class="w-100" color="primary">
                        <input
                          matInput
                          formControlName="prenom"
                          autocomplete="given-name"
                          placeholder="Jean"
                        />
                        <mat-error *ngIf="f.prenom.touched && f.prenom.hasError('required')"
                          >Le prénom est requis.</mat-error
                        >
                        <mat-error *ngIf="f.prenom.touched && f.prenom.hasError('minlength')"
                          >2 caractères minimum.</mat-error
                        >
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <!-- Email -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Adresse email</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="mail"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-primary); opacity: 0.7"
                    ></i-tabler>
                    <input
                      matInput
                      type="email"
                      formControlName="email"
                      autocomplete="email"
                      placeholder="vous@exemple.com"
                    />
                    <mat-error *ngIf="f.email.touched && f.email.hasError('required')"
                      >L'email est requis.</mat-error
                    >
                    <mat-error *ngIf="f.email.touched && f.email.hasError('email')"
                      >Format d'email invalide.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Téléphone -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Téléphone</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="phone"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-primary); opacity: 0.7"
                    ></i-tabler>
                    <input
                      matInput
                      type="tel"
                      formControlName="telephone"
                      placeholder="+261320000000"
                      autocomplete="tel"
                    />
                    <mat-error *ngIf="f.telephone.touched && f.telephone.hasError('required')"
                      >Le téléphone est requis.</mat-error
                    >
                    <mat-error *ngIf="f.telephone.touched && f.telephone.hasError('pattern')"
                      >Format attendu : +261320000000 ou 0320000000.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Mot de passe -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Mot de passe</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="lock"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-primary); opacity: 0.7"
                    ></i-tabler>
                    <input
                      matInput
                      [type]="hidePassword ? 'password' : 'text'"
                      formControlName="password"
                      autocomplete="new-password"
                      placeholder="••••••••"
                    />
                    <button
                      mat-icon-button
                      matSuffix
                      type="button"
                      (click)="hidePassword = !hidePassword"
                    >
                      <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                    </button>
                    <mat-error *ngIf="f.password.touched && f.password.hasError('required')"
                      >Le mot de passe est requis.</mat-error
                    >
                    <mat-error *ngIf="f.password.touched && f.password.hasError('minlength')"
                      >Au moins 6 caractères.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Confirmer -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Confirmer le mot de passe</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="lock-check"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-primary); opacity: 0.7"
                    ></i-tabler>
                    <input
                      matInput
                      [type]="hideConfirmPassword ? 'password' : 'text'"
                      formControlName="confirmPassword"
                      autocomplete="new-password"
                      placeholder="••••••••"
                    />
                    <button
                      mat-icon-button
                      matSuffix
                      type="button"
                      (click)="hideConfirmPassword = !hideConfirmPassword"
                    >
                      <mat-icon>{{
                        hideConfirmPassword ? 'visibility_off' : 'visibility'
                      }}</mat-icon>
                    </button>
                    <mat-error
                      *ngIf="f.confirmPassword.touched && f.confirmPassword.hasError('required')"
                      >Confirmez le mot de passe.</mat-error
                    >
                    <mat-error
                      *ngIf="
                        form.hasError('passwordsMismatch') &&
                        (f.confirmPassword.touched || f.password.touched)
                      "
                    >
                      Les mots de passe doivent être identiques.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <!-- ── Colonne droite : Infos boutique ── -->
            <div class="col-12 col-lg-6" formGroupName="boutique">
              <div class="auth-section auth-section--alt">
                <div class="auth-section__header">
                  <div class="dashboard-badge bg-light-warning text-warning">
                    <i-tabler name="building-store" class="icon-20 d-flex"></i-tabler>
                  </div>
                  <div>
                    <div class="f-s-15 f-w-600">Informations boutique</div>
                    <div class="text-muted f-s-12">Votre espace commercial</div>
                  </div>
                </div>

                <!-- Nom boutique -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Nom de la boutique</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="building-store"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-secondary); opacity: 0.8"
                    ></i-tabler>
                    <input matInput formControlName="nom" placeholder="Ma boutique" />
                    <mat-error *ngIf="b['nom'].touched && b['nom'].hasError('required')"
                      >Le nom est requis.</mat-error
                    >
                    <mat-error *ngIf="b['nom'].touched && b['nom'].hasError('minlength')"
                      >2 caractères minimum.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Adresse -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Adresse</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="map-pin"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-secondary); opacity: 0.8"
                    ></i-tabler>
                    <input
                      matInput
                      formControlName="adresse"
                      autocomplete="street-address"
                      placeholder="Zone A, Box 101"
                    />
                    <mat-error *ngIf="b['adresse'].touched && b['adresse'].hasError('required')"
                      >L'adresse est requise.</mat-error
                    >
                    <mat-error *ngIf="b['adresse'].touched && b['adresse'].hasError('minlength')"
                      >3 caractères minimum.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Téléphone boutique -->
                <div class="auth-field">
                  <mat-label class="auth-field__label">Téléphone de la boutique</mat-label>
                  <mat-form-field appearance="outline" class="w-100" color="primary">
                    <i-tabler
                      name="device-phone"
                      class="icon-18 d-flex"
                      matPrefix
                      style="margin-right: 8px; color: var(--mat-sys-secondary); opacity: 0.8"
                    ></i-tabler>
                    <input
                      matInput
                      type="tel"
                      formControlName="telephone"
                      placeholder="+261320000000"
                      autocomplete="tel"
                    />
                    <mat-error *ngIf="b['telephone'].touched && b['telephone'].hasError('required')"
                      >Le téléphone est requis.</mat-error
                    >
                    <mat-error *ngIf="b['telephone'].touched && b['telephone'].hasError('pattern')"
                      >Format attendu : +261320000000 ou 0320000000.</mat-error
                    >
                  </mat-form-field>
                </div>

                <!-- Info box -->
                <div class="auth-info-box">
                  <div class="auth-info-box__icon bg-light-primary text-primary">
                    <i-tabler name="info-circle" class="icon-18 d-flex"></i-tabler>
                  </div>
                  <div>
                    <div class="f-s-13 f-w-600 m-b-4">Information importante</div>
                    <p class="text-muted f-s-12 m-0" style="line-height: 1.6">
                      Ces informations seront visibles par vos clients et pourront être modifiées
                      plus tard depuis votre tableau de bord.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Erreur serveur -->
          <div *ngIf="serverError" class="auth-server-error m-t-24">
            <i-tabler name="alert-circle" class="icon-16 d-flex"></i-tabler>
            {{ serverError }}
          </div>

          <!-- Submit -->
          <button
            type="submit"
            mat-flat-button
            color="primary"
            class="w-100 auth-submit"
            [disabled]="form.invalid || isSubmitting"
          >
            {{ isSubmitting ? 'Création en cours…' : 'Créer ma boutique' }}
          </button>
        </form>

        <!-- ── Lien login ── -->
        <div class="auth-register">
          Déjà un compte ?
          <a [routerLink]="['/boutique/login']" class="text-primary f-w-600 text-decoration-none">
            Se connecter
          </a>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
